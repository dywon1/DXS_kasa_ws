<p align="center">
  <img src="https://github.com/user-attachments/assets/d32a9c5b-853f-400f-be54-fc8f909b2e9a" width="70%" /> 
  <img src="https://github.com/user-attachments/assets/64643e95-c9eb-455a-b7e0-09a4a1da2eb9" width="20%" />
</p>


# 한국교통안전공단 주관 대학생 창작 자율주행 자동차대회

## KASA 프로젝트 포트폴리오

본 저장소는 자율주행 차량 개발을 위한 세 가지 주요 패키지를 포함하고 있습니다:

1. **lidar**: LiDAR 센서 데이터 처리 및 장애물 감지
2. **path_planning**: 경로 계획 및 경로 생성 알고리즘
3. **control**: 차량의 종방향 및 횡방향 제어 알고리즘

각 패키지는 자율주행 차량의 특정 기능을 담당하며, 전체적으로 통합되어 자율주행 시스템을 구성합니다.

---

## 목차

- [프로젝트 소개](#프로젝트-소개)
- [패키지 구성](#패키지-구성)
  - [1. lidar](#1-lidar)
  - [2. path_planning](#2-path_planning)
  - [3. control](#3-control)
- [사용 기술 및 개발 환경](#사용-기술-및-개발-환경)
- [시스템 요구 사항](#시스템-요구-사항)
- [사용 방법](#사용-방법)
- [활동자료](#활동자료)
- [프로젝트 성과 및 경험](#프로젝트-성과-및-경험)
- [프로젝트 구조](#프로젝트-구조)
- [개인 기여도](#개인-기여도)
- [문의](#문의)

---

## 프로젝트 소개

이 프로젝트는 **한국교통안전공단이 주관하는 대학생 창작 자율주행 자동차대회** 참가를 위해 개발되었습니다. 대회에서는 차량 전방의 꼬깔콘을 인식하고, 그 사이의 경로를 따라 자율주행하는 것이 목표였습니다.

**저는 팀의 파트장으로서, 팀원들에게 ROS2의 기초와 코딩 방법을 교육하고, 인지, 판단, 제어에 대한 전체적인 지휘와 조정을 담당하였습니다.**

---

## 패키지 구성

<p align="center">
  <img src="https://github.com/user-attachments/assets/1e4c3a70-edde-4ba9-aa23-af2f3874404f" width="30%" />
  <img src="https://github.com/user-attachments/assets/65cbc2af-54eb-4645-af66-b0e04bfb78b5" width="30%" />
  <img src="https://github.com/user-attachments/assets/1c4a42e2-f1a0-4b42-a602-5e4aed9a4f7c" width="30%: />
</p>

### 1. **lidar**

LiDAR 센서로부터 수집된 포인트 클라우드 데이터를 처리하여 차량 전방의 꼬깔콘을 감지하고, RANSAC 및 필터링을 통해 노이즈를 제거하여 최적화합니다.

**주요 기능 및 기여사항:**

- **sampling.cpp**: Voxel Grid Downsample을 통해 LiDAR 데이터 양을 줄이고 노이즈를 제거하여 최적화합니다.
- **roi.cpp**: 차량 전방의 관심 영역만 선택하여 처리합니다.
- **ransac.cpp**: 아웃라이어 제거 및 지면 제거를 통해 꼬깔콘만 남게 합니다.
- **parameters.yaml**: 위 3개 코드의 파라미터를 조정합니다.
- **기여도**:
  - **작년**: LiDAR 데이터의 인지 가공을 Python으로 구현하였습니다.
  - **올해**: Python으로 작성한 코드를 C++로 변환하는 과정에서 원본 코드 제공과 지원을 통해 **50% 기여**하였습니다.


[스크린캐스트 10-27-2024 01:55:13 AM.webm](https://github.com/user-attachments/assets/1e9b558d-8e11-42db-9842-b52e7f407eed)

### 2. **path_planning**

차량 전방의 꼬깔콘 PCD를 받아 클러스터링 및 CCW 알고리즘을 통해 꼬깔콘 사이의 중점 경로를 생성합니다.

**주요 기능 및 기여사항:**

- **전체 기능 구현**: 올해 **C++로 새롭게 개발**하였습니다.
- **클러스터링 알고리즘 개발**: 수신된 꼬깔콘 데이터를 클러스터링하여 개별 꼬깔콘의 위치를 파악합니다.
- **CCW 알고리즘 적용**: 차량에서 멀리 떨어져 있는 경로까지 계산하기 위해 CCW 알고리즘을 적용하였습니다.
- **시각화 및 데이터 전달**: `marker_array`와 `float32_multi_array`를 통해 시각화와 경로 데이터를 다른 노드로 전달합니다.
- **기여도**: **패키지 전체를 100% 개발**하였습니다.

### 3. **control**

계획된 경로를 따라 차량을 제어하는 알고리즘을 제공합니다. 종방향 제어(속도 제어)와 횡방향 제어(조향각 제어)를 포함합니다.

**주요 기능 및 기여사항:**

- **PID 제어기를 이용한 속도 제어**
- **Pure Pursuit 및 Stanley 제어기를 이용한 조향각 제어**
- **곡률에 따른 동적 속도 조절**
- **센서 데이터 피드백을 통한 제어기 튜닝**
- **기여도**:
  - **작년**: IMU와 GPS 센서 데이터를 처리하여 **속도 계산**과 **헤딩** 구현을 담당하였습니다.
  - **올해**: IMU와 GPS를 센서 퓨전하여 **저속, 중속, 고속 상황별로 신뢰도를 가변적으로 적용**하여 **신뢰도 높은 헤딩과 속도 값을 구현**하였습니다.
  - **인지, 판단, 제어에 대한 전반적인 지휘와 조정**을 담당하였으며, 제어 알고리즘의 구현과 개선에 **주요한 역할**을 하였습니다.

---

## 사용 기술 및 개발 환경

- **프로그래밍 언어**: C++, Python
- **프레임워크 및 라이브러리**:
  - ROS2 Humble Hawksbill
  - PCL (Point Cloud Library)
  - OpenCV
  - Eigen
- **알고리즘 및 기법**:
  - 클러스터링 알고리즘
  - Convex Hull 알고리즘 (CCW)
  - RANSAC 알고리즘
  - 센서 퓨전 (IMU와 GPS 데이터 결합)
  - PID 제어기, Pure Pursuit, Stanley 제어기
- **개발 환경**:
  - Ubuntu 22.04
  - Ouster OS1-32 LiDAR 센서
  - RViz2를 이용한 시각화

---

## 시스템 요구 사항

- **Ubuntu 22.04**
- **ROS2 Humble Hawksbill**
- **C++14** 이상
- **Python 3.10** 이상
- **Ouster OS1-32 LiDAR 센서 드라이버**

---

## 사용 방법

### 1. LiDAR 데이터 수집 및 처리

LiDAR 센서 드라이버를 실행하고, `lidar` 패키지를 실행하여 LiDAR 데이터를 최적화합니다.

```bash
# LiDAR 패키지 실행
ros2 launch lidar lidar.launch.py
```

RViz2가 실행되며 시각화를 할 수 있습니다.

### 2. 경로 계획 실행

환경 데이터가 수집되면, `path_planning` 패키지를 실행하여 경로를 계획합니다.

```bash
ros2 run path_planning path_planning
```

### 3. 차량 제어 실행

계획된 경로를 기반으로 차량을 제어합니다.

```bash
ros2 run control control_node
```

---

## 활동자료

![나래돔 단체사진](https://github.com/user-attachments/assets/5c83f5f0-d624-4d08-8808-efd7ea8f9127)
![KakaoTalk_20241027_013952656_02](https://github.com/user-attachments/assets/22f450ff-13e1-4eb2-9dd9-e6381a9d9502)
![KakaoTalk_20241027_013952656](https://github.com/user-attachments/assets/7f1f60a5-9ac0-4dce-9f4a-cd98a1610fdc)
![KakaoTalk_20241027_013952656_01](https://github.com/user-attachments/assets/2f32a55e-41f4-41f5-b36b-67105f1db410)
![KakaoTalk_20241027_014116421](https://github.com/user-attachments/assets/d9fd6125-bf8b-4231-83e2-532b3d756471)

---

## 프로젝트 성과 및 경험

- **경로 계획 알고리즘의 정확도 향상**: 클러스터링 및 CCW 알고리즘을 최적화하여 차량이 안정적으로 경로를 추종할 수 있도록 구현하였습니다.
- **제어 알고리즘의 성능 개선**: IMU와 GPS 센서 퓨전을 통해 다양한 속도 상황에서 신뢰도 높은 헤딩과 속도 값을 제공하여 제어 성능을 향상시켰습니다.
- **팀 리더십 경험**: 파트장으로서 팀원들에게 ROS2 기초와 코딩 방법을 교육하고, 프로젝트의 방향성을 제시하였습니다.
- **협업 및 교육 역량 강화**: 여러 팀원들과 협업하여 프로젝트를 진행하면서 의사소통과 문제 해결 능력을 향상시켰습니다.
- **문제 해결 능력 향상**: 센서 데이터의 노이즈 처리, 센서 퓨전, 좌표계 변환 등 실제 현장에서 발생하는 문제들을 해결하며 개발 역량을 키웠습니다.

---

## 프로젝트 구조

```
ros2_ws/
├── src/
│   ├── lidar/
│   ├── path_planning/
│   └── control/
├── install/
├── build/
└── log/
```

- `lidar`: LiDAR 데이터 처리 패키지
- `path_planning`: 경로 계획 패키지
- `control`: 차량 제어 패키지

---

## 개인 기여도

본 프로젝트는 팀 프로젝트로 진행되었으며, 저는 다음과 같은 부분에서 주도적으로 참여하였습니다:

- **`path_planning` 패키지 개발 (100%)**
  - C++로 새롭게 패키지를 개발하였습니다.
  - 클러스터링 알고리즘 및 CCW 알고리즘을 적용하여 경로 생성 기능을 구현하였습니다.
  - 경로 시각화 및 데이터 전달 기능을 구현하였습니다.

- **`lidar` 패키지 개발 (약 50% 기여)**
  - **작년**: Python으로 LiDAR 데이터의 인지 가공을 단독으로 구현하였습니다.
  - **올해**: Python 코드를 C++로 변환하는 과정에서 원본 코드 제공과 지원을 통해 50% 기여하였습니다.

- **`control` 패키지 개발**
  - **작년**: IMU와 GPS 센서 데이터를 처리하여 **속도 계산**과 **헤딩** 구현을 담당하였습니다.
  - **올해**: IMU와 GPS를 센서 퓨전하여 **저속, 중속, 고속 상황별로 신뢰도를 가변적으로 적용**하여 **신뢰도 높은 헤딩과 속도 값을 구현**하였습니다.
  - **인지, 판단, 제어에 대한 전반적인 지휘와 조정**을 담당하였으며, 제어 알고리즘의 구현과 개선에 주요한 역할을 하였습니다.
  - 팀원들에게 ROS2와 코딩 방법을 교육하고, 프로젝트의 방향성을 제시하였습니다.

---

## 문의

프로젝트에 대한 문의나 제안 사항이 있으시면 아래로 연락주시기 바랍니다.

- **Email**: wdy9876@koreatech.ac.kr

---
